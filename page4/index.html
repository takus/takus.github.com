
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>TAKUMI SAKAMOTO&#8217;S BLOG</title>
  <meta name="author" content="Takumi Sakamoto">

  
  <meta name="description" content="前回の"Los Angeles に行ってきた&ldquo;の続きです。New York 編。 Manhattan by takus Tips Unlimited Ride MetroCard 市内であれば、ほとんどの場所に地下鉄で行けるので地下鉄の乗り放題パスを買うと捗ります。7 日間乗り放題で &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.takus.me/page4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="TAKUMI SAKAMOTO'S BLOG" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2841066-12']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">TAKUMI SAKAMOTO&#8217;S BLOG</a></h1>
  
    <h2>A weblog about Web Operations, Programming, Football, Travel and Other My Interests.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.takus.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://about.me/takus">AboutMe</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/05/12/travel-to-new-york/">New York に行ってきた</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/05/12/travel-to-new-york/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/05/12/travel-to-new-york/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-12T02:16:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>2:16 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前回の&#8221;<a href="/2013/05/11/travel-to-los-angeles/">Los Angeles に行ってきた</a>&ldquo;の続きです。New York 編。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7342/8724104724_11f346d201_b.jpg" class="fancybox" data-title-id="flickr-photo-8724104724" data-media="photo"><img src="http://farm8.staticflickr.com/7342/8724104724_11f346d201_z.jpg" title="Manhattan" style=""/></a><figcaption id="flickr-photo-8724104724"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8724104724">Manhattan</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Tips</h2>

<p><a href="http://mta.info/metrocard/mcgtreng.htm#unlimited">Unlimited Ride MetroCard</a></p>

<p>市内であれば、ほとんどの場所に地下鉄で行けるので地下鉄の乗り放題パスを買うと捗ります。7 日間乗り放題で $30 と無駄に期間が長くて使い切れないですが、すぐに元取れます。</p>

<p><a href="http://www.citypass.com/new-york">NEW YORK CityPASS</a></p>

<p>とりあえず初めて NY 行く人はこれを買っておくといいと思います。エンパイアステートビル展望台、メトロポリタン美術館、アメリカ自然史博物館、トップオブザロック展望台、近代美術館、自由の女神周辺のフェリー観光ができて、$106 は個別にチケットを買うよりはかなりお得です。旅行行く前にオンラインで支払って、バーコード入りのチケットを印刷して持って行けば OK です。</p>

<h2>Statue of Liverty</h2>

<p>フェリーで自由の女神からブルックリン橋まで Manhattan 島の南部を全体的に回ってくれてだいぶ満足できるツアーになってます。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7352/8720660765_813eac478e_b.jpg" class="fancybox" data-title-id="flickr-photo-8720660765" data-media="photo"><img src="http://farm8.staticflickr.com/7352/8720660765_813eac478e_z.jpg" title="Statue of Liberty" style=""/></a><figcaption id="flickr-photo-8720660765"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8720660765">Statue of Liberty</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>911 Memorial</h2>

<p>すでに One World Trade Center と呼ばれる新しいビルが天空高くそびえ立っていましたが、こんなビルが跡形もなく崩れ去るなんてとても想像できないわけで、自分の中での 9/11 に対する見方が変わって、遠い国の出来事から急にすごくリアルな出来事に思えるようになりました。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7389/8722983477_a8f1c7f366_b.jpg" class="fancybox" data-title-id="flickr-photo-8722983477" data-media="photo"><img src="http://farm8.staticflickr.com/7389/8722983477_a8f1c7f366_z.jpg" title="One World Trade Center" style=""/></a><figcaption id="flickr-photo-8722983477"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8722983477">One World Trade Center</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Brooklyn Bridge</h2>

<p>全長 2km くらいなので歩いて渡ると楽しめます。Manhattan 側から歩いていき、Brooklyn 側の公園でアイスを食べながら一休みして地下鉄で帰りました。</p>

<p><figure class="flickr-thumbnail" style="width: 425px;"><a href="http://farm8.staticflickr.com/7415/8720841273_26a67d351a_b.jpg" class="fancybox" data-title-id="flickr-photo-8720841273" data-media="photo"><img src="http://farm8.staticflickr.com/7415/8720841273_26a67d351a_z.jpg" title="Load to ..." style="width: 425px; height: 640px;"/></a><figcaption id="flickr-photo-8720841273"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8720841273">Load to &hellip;</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Yankee Stadium</h2>

<p>せっかくなのでメジャーリーグも見てきました。オンラインでチケット買ってくこともできますが、人気カードでない限り当日スタジアム行って買えば問題ないです。$50 くらいのチケット買いましたが、球場内の移動が割と自由で写真のように内野席の後ろとか入れて立ち見できるので、一番安いチケット買って歩き回るのがベストなんじゃないかと思います。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7292/8722117732_46ae34ba9b_b.jpg" class="fancybox" data-title-id="flickr-photo-8722117732" data-media="photo"><img src="http://farm8.staticflickr.com/7292/8722117732_46ae34ba9b_z.jpg" title="Yankee Stadium" style=""/></a><figcaption id="flickr-photo-8722117732"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8722117732">Yankee Stadium</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Top of The Rock &amp; Empire State Buinding</h2>

<p>New York の町を一望できる場所として、この 2 箇所がありますが、夜景を楽しむなら Empire State Building のライトアップを見れる Top of The Rock に行くのが正解です。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7328/8724103864_a80b3ba6d5_b.jpg" class="fancybox" data-title-id="flickr-photo-8724103864" data-media="photo"><img src="http://farm8.staticflickr.com/7328/8724103864_a80b3ba6d5_z.jpg" title="From Top of The Rock" style=""/></a><figcaption id="flickr-photo-8724103864"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8724103864">From Top of The Rock</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7346/8722151228_15496964e4_b.jpg" class="fancybox" data-title-id="flickr-photo-8722151228" data-media="photo"><img src="http://farm8.staticflickr.com/7346/8722151228_15496964e4_z.jpg" title="From Empire State Building" style=""/></a><figcaption id="flickr-photo-8722151228"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8722151228">From Empire State Building</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>I Love New York</h2>

<p>ほかにもアメリカ自然史博物館で子供の頃から見たかった恐竜を見たり、セントラルパーク散歩したり、色々と楽しい思い出ばかりで、I Love NY の T シャツを着てる人の気持ちが理解できた気がします。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/05/11/travel-to-los-angeles/">Los Angeles に行ってきた</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/05/11/travel-to-los-angeles/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/05/11/travel-to-los-angeles/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-11T22:38:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:38 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>帰ってきてから 1 週間ぐらいたってしまいましたが、ゴールデンウィークを利用して Los Angeles と New York に行ってきたのでまとめ。ひとまず Los Angeles 編。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7447/8722983851_3d7e9c0092_b.jpg" class="fancybox" data-title-id="flickr-photo-8722983851" data-media="photo"><img src="http://farm8.staticflickr.com/7447/8722983851_3d7e9c0092_z.jpg" title="Walt Disney Concert Hall" style=""/></a><figcaption id="flickr-photo-8722983851"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8722983851">Walt Disney Concert Hall</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>We Need a Car</h2>

<p><a href="/2012/03/24/28199464257/">ヨーロッパ旅行</a>の感覚で現地に着いてから色々考えようとか思ってましたが、公共交通機関で移動すると時間かかりすぎなのが非常に辛い町でした。ロサンゼルス国際空港の近くのホテルに宿泊していましたが、ビーチで有名な Santa Monica まではバスで 40 分程度、Hollywood までは 1 時間はかかってしまいます。逆にタクシーだとそれぞれ 30 分程度で着いてしまうので、レンタカー借りて移動するのが正解でした&hellip;。</p>

<h2>Disney Resort</h2>

<p>California の Disney Resort は LAX から南に車で 40 分ほどの Anaheim にあります。LAX からは有料のシャトルバスが出ていて、&#8221;Long Distance Vans&#8221; と書かれた緑色の案内版の下で待ってると &ldquo;Disney Resort&rdquo; と書かれたバスが通るので合図して停車してもらって乗ります。片道 $20 程度。「帰りも乗ってくか？」と聞かれたので、「09:00 からショーがあってそれを見たいから 10:00 に迎えに来てくれて、ホテルまで送ってくれるなら」と交渉したところ、「ノープロブレム」とのことだったのでお願いしました。</p>

<p>日本におけるディズニーランドとディズニーシーのように、Disney Park と Disney California Park の 2 つがあったので、1 日でどちらにも出入りが自由な Park Hopper Ticket を $125 で購入。日本のディズニーランドが 6200 円なので大体同じくらいの感覚なんじゃないかと思います。</p>

<p>日本のディズニーランドと違ってとにかく人が少なくて過ごしやすかったです。一番待ったアトラクションで 20 分程度でファストパスを取っていればほぼ待ち時間なしで乗れました。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7301/8720357169_473dfffc07_b.jpg" class="fancybox" data-title-id="flickr-photo-8720357169" data-media="photo"><img src="http://farm8.staticflickr.com/7301/8720357169_473dfffc07_z.jpg" title="Disney Park" style=""/></a><figcaption id="flickr-photo-8720357169"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8720357169">Disney Park</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7412/8720395281_1e4eeb4f80_b.jpg" class="fancybox" data-title-id="flickr-photo-8720395281" data-media="photo"><img src="http://farm8.staticflickr.com/7412/8720395281_1e4eeb4f80_z.jpg" title="Disney California Park" style=""/></a><figcaption id="flickr-photo-8720395281"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8720395281">Disney California Park</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Hollywood</h2>

<p>日本でいうと原宿っぽい印象。ショッピングする人にはいいのかもしれませんがあまり好きになれそうな場所ではなく、蝋人形館と Hollywood のサインだけ見て撤収しました。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7424/8720523969_4cb66b7bfe_b.jpg" class="fancybox" data-title-id="flickr-photo-8720523969" data-media="photo"><img src="http://farm8.staticflickr.com/7424/8720523969_4cb66b7bfe_z.jpg" title="HOLLYWOOD" style=""/></a><figcaption id="flickr-photo-8720523969"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8720523969">HOLLYWOOD</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Santa Monica</h2>

<p>青い空に青い海。California といったら Santa Monica なイメージ。まだシーズン前なのか人はいるものの静かだったのでぼーっと海を眺めてました。海岸線をドライブしたら気持ちいいだろうなと思って、レンタカー借りなかったのを余計に後悔する結果になりました。</p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7380/8721679896_b72e27414e_b.jpg" class="fancybox" data-title-id="flickr-photo-8721679896" data-media="photo"><img src="http://farm8.staticflickr.com/7380/8721679896_b72e27414e_z.jpg" title="Santa Monica" style=""/></a><figcaption id="flickr-photo-8721679896"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8721679896">Santa Monica</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7427/8721678594_9b88f32591_b.jpg" class="fancybox" data-title-id="flickr-photo-8721678594" data-media="photo"><img src="http://farm8.staticflickr.com/7427/8721678594_9b88f32591_z.jpg" title="Santa Monica Beach" style=""/></a><figcaption id="flickr-photo-8721678594"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8721678594">Santa Monica Beach</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<p><figure class="flickr-thumbnail" style="display: inline-block;"><a href="http://farm8.staticflickr.com/7285/8721669036_7d2d2ef96a_b.jpg" class="fancybox" data-title-id="flickr-photo-8721669036" data-media="photo"><img src="http://farm8.staticflickr.com/7285/8721669036_7d2d2ef96a_z.jpg" title="Santa Monica Pier" style=""/></a><figcaption id="flickr-photo-8721669036"><h1><a class="flickr-link" href="http://www.flickr.com/photos/38933684@N07/8721669036">Santa Monica Pier</a> by takus</h1><div class="description"></div></figcaption></figure></p>

<h2>Fun with Wide Angle Lens</h2>

<p><img src="http://ecx.images-amazon.com/images/I/41OigRRF6lL._SL160_.jpg" width="160" height="128"></p>

<p>この旅行に向けて広角レンズを買ったわけですが、景色撮るのが好きなら 1 本持っていて損はないんじゃないかと思いました。旅行にもお金かかってそんなに予算がなく、<a href="http://www.amazon.co.jp/exec/obidos/ASIN/B001FB6PJI/takus-22/ref=nosim">TAMRON SP AF10-24mm F/3.5-4.5</a> を購入しましたが、絞って使えば周辺もそれなりに解像してくれてコストパフォーマンスはいいレンズです。上記の写真も Hollywood サインの写真以外はこれで撮影してます。</p>

<h2>Summay</h2>

<ul>
<li>色々とツライ思いをするので Los Angeles はレンタカーで観光しましょう</li>
<li>Disney Park は日本のディズニーより楽しいです（待たなくていいのが）</li>
<li>広角レンズ捗ります</li>
</ul>


<p>後編 &ldquo;<a href="/2013/05/12/travel-to-new-york/">New York に行ってきた</a>&#8220;に続きます。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/05/01/crontab-date/">crontab で date コマンド使う場合の注意</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/05/01/crontab-date/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/05/01/crontab-date/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-05-01T09:55:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>9:55 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>crontab で定期的にを実行したときに出力されたものをログとして書き出すときに、ファイル名のサフィックスとして日時をつけることでログローテーションさせたいというケースはあると思います。ですが、以下のような記述はうまくいきません。</p>

<pre><code>0 0 * * * /home/takus/bin/oreno_script.pl &gt; /tmp/log.`date -d '1 days ago' +%Y%m%d` 2&gt;&amp;1
</code></pre>

<p>これは % が crontab では特別な意味を持つ文字であるのが原因で、下記のように % はバックスラッシュでエスケープしておく必要があります。</p>

<pre><code>0 0 * * * /home/takus/bin/oreno_script.pl &gt; /tmp/log.`date -d '1 days ago' +\%Y\%m\%d` 2&gt;&amp;1
</code></pre>

<p>crontab は man を読んで正しく使いましょう。</p>

<h2>参考</h2>

<p>詳細は man 5 crontab で確認できます。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/04/25/supergrep/">ブラウザから tail -f log | grep keyword できるツール supergrep</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/04/25/supergrep/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/04/25/supergrep/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-04-25T00:00:00-07:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>エンジニアならサーバにログインしてコマンド打てば済む話ですが、世の中には非エンジニアでも tail -f log | grep keyword みたいにログを見れるようにしたいという案件がたまにあるみたいです。自分で書いてもよかったのですが、supergrep というツールがあったので使ってみました。</p>

<ul>
<li><a href="http://codeascraft.etsy.com/2012/06/28/is-it-a-bird-is-it-a-plane-no-its-supergrep/">Is It A Bird? Is It A Plane? No, It’s Supergrep!</a></li>
<li><a href="https://github.com/etsy/supergrep">esty/supergrep</a></li>
</ul>


<h2>インストール</h2>

<p>supergrep は node.js で書かれているので、node のインストールから。node の作法はよく知らないので適当です。</p>

<figure class='code'><figcaption><span>install supergrep </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git clone https://github.com/creationix/nvm.git ~/nvm
</span><span class='line'><span class="nv">$ </span>. ~/nvm/nvm.sh
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>nvm install v0.10.5
</span><span class='line'><span class="nv">$ </span>nvm <span class="nb">alias </span>default v0.10.5
</span><span class='line'><span class="nv">$ </span>node -v
</span></code></pre></td></tr></table></div></figure>


<p>続いて supergrep をインストールして起動します。これだけ。起動時に &lsquo;Warning: express.createServer() is deprecated, express&rsquo; が出るのはご愛敬。</p>

<figure class='code'><figcaption><span>install supergrep </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git clone https://github.com/etsy/supergrep.git
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>supergrep
</span><span class='line'><span class="nv">$ </span>npm install
</span><span class='line'><span class="nv">$ </span>./runlocal
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://hostname:3000">http://hostname:3000</a> にブラウザからアクセスするとログが見れる状態になりました。</p>

<p><img src="http://farm9.staticflickr.com/8402/8677559587_e5abefa49e_z.jpg" width="800" height="250"></p>

<h2>設定</h2>

<p>デフォルトでは /var/log/httpd/{info.log,php.log} を見るようになっていますが、他のログもみたい場合は localConfig.js にログのパスを追加します。他にも IRC にポストできそうな config 等もありましたが、今回は必要としてないので調べてません。</p>

<figure class='code'><figcaption><span>localConfig.js </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>    <span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;web&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">path</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;/var/log/httpd/info.log&#39;</span><span class="p">,</span> <span class="s1">&#39;/var/log/httpd/php.log&#39;</span><span class="p">]</span>
</span><span class='line'>            <span class="c1">// you can also do this</span>
</span><span class='line'>            <span class="c1">//            filter: function (line, config) {</span>
</span><span class='line'>            <span class="c1">//                if (! line.match(config.noisyErrors)) {</span>
</span><span class='line'>            <span class="c1">//                    return line;</span>
</span><span class='line'>            <span class="c1">//                } else {</span>
</span><span class='line'>            <span class="c1">//                    return;</span>
</span><span class='line'>            <span class="c1">//               }</span>
</span><span class='line'>            <span class="c1">//            }</span>
</span><span class='line'>            <span class="c1">//</span>
</span><span class='line'>            <span class="c1">//  make sure to define below (in the config namespace):</span>
</span><span class='line'>            <span class="c1">//    noisyErrors: new RegExp (/(something to ignore)/),</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="c1">// add more files entries here if you want</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;app&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">maxLines</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;/data/oreno/app.log&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">],</span>
</span></code></pre></td></tr></table></div></figure>


<p>このままだとダッシュボードで操作できなかったので下記の設定を static/index.html に追加したり。</p>

<figure class='code'><figcaption><span>static/index.html </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;logsource-options&quot;</span> <span class="na">class=</span><span class="s">&quot;display-option-group&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;display-option&quot;</span> <span class="na">for=</span><span class="s">&quot;log-web&quot;</span><span class="nt">&gt;</span>Web: <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;log-web&quot;</span> <span class="na">class=</span><span class="s">&quot;log-option&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-log=</span><span class="s">&quot;web&quot;</span> <span class="na">tabindex=</span><span class="s">&quot;120&quot;</span> <span class="na">checked</span><span class="nt">&gt;&lt;/label&gt;</span>
</span><span class='line'>    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">&quot;display-option&quot;</span> <span class="na">for=</span><span class="s">&quot;log-app&quot;</span><span class="nt">&gt;</span>App: <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;log-app&quot;</span> <span class="na">class=</span><span class="s">&quot;log-option&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-log=</span><span class="s">&quot;app&quot;</span> <span class="na">tabindex=</span><span class="s">&quot;120&quot;</span> <span class="na">checked</span><span class="nt">&gt;&lt;/label&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>tail -f log | grep keyword</h2>

<p>見にくいですが、キーワード指定してフィルタリングできます。チェック押せば grep -v もできます。</p>

<p><img src="http://farm9.staticflickr.com/8399/8678666106_1e7cb86c29_z.jpg" width="800" height="250"></p>

<p>ハイライトもできるので、CRITICAL や、特定のホスト名だけ目立たせてもよさそうです。</p>

<p><img src="http://farm9.staticflickr.com/8265/8678666130_803c58ee4b_z.jpg" width="800" height="250"></p>

<h2>まとめ</h2>

<p>今回は非エンジニアにログを見せるという案件のために使ってみましたが、インストール簡単でそれなりに機能が豊富なので色々と使い道は多そうなツールになっていて、スマホからも見れるので休日のアラート対応などでちょっと Mac 開けないみたいな場合の状況確認なんかにも使えそうです。</p>

<p>同じようなツールに riywo さんが紹介していた <a href="http://tech.riywo.com/blog/2013/04/23/webtail-plus-ncat-equals-simple-log-monitoring-slash/">webtail</a> みたいなものもあるみたいで、こちらは標準入力からログを受け取れるあたりがカジュアルでよさそうに思いました。</p>

<p>関係ない話ですが octopress で勝手に capitalize されるのがウザい場合、_config.yml で titlecase: false すると幸せになれるみたいです。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/03/28/riak-install/">CentOS に Riak をインストール & Data::Riak::Fast で操作してみる</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/03/28/riak-install/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/03/28/riak-install/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-03-28T11:00:00-07:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>11:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近、社内 TechTalk で何か話せという依頼があり、ちょうど <a href="http://www.zusaar.com/event/563010">Riak Serious Talk</a> もあるので、<a href="http://docs.basho.com/riak/latest/">Riak</a> についてアーキテクチャから利用例まで調べて話してみました。その課程で Riak のインストール等したので適当にブログっておきます。</p>

<h2>インストール</h2>

<p><a href="http://www.vagrantbox.es/">Vagrantbox.es</a> から <a href="http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20130309.box">CentOS 6.4 x86_64 Minimal</a> を持ってきてテストサーバを用意。起動後にひとまず iptables だけ停止。Vagrant の操作などは割愛します。</p>

<h3>依存パッケージ導入</h3>

<p>Erlang をインストールするのに必要なパッケージをインストールします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo yum groupinstall “Development tools”
</span><span class='line'>sudo yum install git
</span><span class='line'>sudo yum install libwx unixODBC.x86_64 unixODBC-devel.x86_6 wxBase.x86_64 wxGTK.x86_64 wxGTK-gl
</span><span class='line'>
</span><span class='line'>wget https://elearning.erlang-solutions.com/couchdb//rbingen_adapter//package_R15B01_centos664_1333462308/esl-erlang-R15B01-1.x86_64.rpm
</span><span class='line'>sudo rpm -ivh esl-erlang-R15B01-1.x86_64.rpm
</span></code></pre></td></tr></table></div></figure>


<h3>Riak をインストール</h3>

<p>とりあえず make まで。ソースは <a href="http://docs.basho.com/riak/latest/downloads/">Basho のサイト</a>から入手できます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>wget http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/1.3/1.3.0/riak-1.3.0.tar.gz
</span><span class='line'>tar zxvf riak-1.3.0.tar.gz
</span><span class='line'><span class="nb">cd </span>riak-1.3.0
</span><span class='line'>make devrel
</span></code></pre></td></tr></table></div></figure>


<h3>Riak を起動してみる</h3>

<p>4 ノードを起動。ulimit しているのはなしだと警告が出るので一応。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">ulimit</span> -n 4096
</span><span class='line'>dev/dev1/bin/riak start
</span><span class='line'>dev/dev2/bin/riak start
</span><span class='line'>dev/dev3/bin/riak start
</span><span class='line'>dev/dev4/bin/riak start
</span></code></pre></td></tr></table></div></figure>


<p>起動しただけではノード同士は接続されてない状態なので、ノード同士を接続します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>dev/dev2/bin/riak-admin cluster join dev1@127.0.0.1
</span><span class='line'>dev/dev3/bin/riak-admin cluster join dev1@127.0.0.1
</span><span class='line'>dev/dev4/bin/riak-admin cluster join dev1@127.0.0.1
</span></code></pre></td></tr></table></div></figure>


<h2>Data::Riak::Fast で操作してみる</h2>

<p>Perl のクライアントとして、<a href="http://search.cpan.org/~franckc/Net-Riak/">Net::Riak</a> が以前からありますが、<a href="https://gist.github.com/myfinder/5232845">ベンチマーク</a>すると遅いらしいです。@myfinder さんが <a href="https://github.com/myfinder/p5-riak-lite">Riak::Lite</a>、<a href="https://github.com/myfinder/p5-data-riak-fast">Data::Riak::Fast</a> を作ってくれているので、Data::Riak::Fast を使って操作してみます。</p>

<figure class='code'><figcaption><span>riak-test.pl perl </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#!/usr/bin/env perl</span>
</span><span class='line'><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="nn">Data::</span><span class="n">Dumper</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">Data::Riak::</span><span class="n">Fast</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">JSON::</span><span class="n">XS</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">my</span> <span class="nv">$riak</span> <span class="o">=</span> <span class="nn">Data::Riak::</span><span class="n">Fast</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span>
</span><span class='line'>    <span class="n">transport</span> <span class="o">=&gt;</span> <span class="nn">Data::Riak::Fast::</span><span class="n">HTTP</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span>
</span><span class='line'>        <span class="n">host</span> <span class="o">=&gt;</span> <span class="s">&#39;192.168.33.10&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="n">port</span> <span class="o">=&gt;</span> <span class="s">&#39;10018&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">),</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># stats</span>
</span><span class='line'><span class="k">my</span> <span class="nv">$stat</span> <span class="o">=</span> <span class="nv">$riak</span><span class="o">-&gt;</span><span class="n">stats</span><span class="p">();</span>
</span><span class='line'><span class="k">print</span> <span class="n">Dumper</span><span class="p">(</span><span class="nv">$stat</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># bucket</span>
</span><span class='line'><span class="k">my</span> <span class="nv">$bucket</span> <span class="o">=</span> <span class="nv">$riak</span><span class="o">-&gt;</span><span class="n">bucket</span><span class="p">(</span><span class="s">&#39;my_bucket&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># put</span>
</span><span class='line'><span class="nv">$bucket</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># get</span>
</span><span class='line'><span class="k">my</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$bucket</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>まとめ</h2>

<p>Riak の利用例みてたら node.js + Riak + Redis で <a href="http://clipboard.com/">clipboard.com</a> を作ってるとか、色々と面白そうな使い方してる例が多そうで、特に <a href="https://speakerdeck.com/jnewland/github-pages-on-riak-and-webmachine">GitHub Pages のホスティングの話</a> がよさげだったので、同じような仕組み作ってみたいとか思ってる次第です。</p>

<h2>参考等</h2>

<ul>
<li><a href="https://speakerdeck.com/kuenishi/riak-and-and-riak-cs">Riak &amp;&amp; Riak CS</a></li>
<li><a href="https://speakerdeck.com/wfarr/learn-you-some-riak">Learn You Some Riak</a></li>
<li><a href="https://vimeo.com/52417831">Building a Social Application on Riak &ndash; Gary Flake, RICON2012</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/03/22/test-web-api-client/">Test::Fake::HTTPD で Web API クライアントをテスト</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/03/22/test-web-api-client/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/03/22/test-web-api-client/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-03-22T03:00:00-07:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2013</span></span> <span class='time'>3:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ある社内向け Web API のクライアントのテスト書く時にどうすべきかなと小一時間調べてみて、<a href="https://metacpan.org/module/Test::Fake::HTTPD">Test::Fake::HTTPD</a> がよさそうなので使ってみたメモ。思うがままにレスポンス返せるし、実際に本番サーバ叩いたりしなくてもいいし、オフラインでもテストできて、だいぶテストが捗りそうです。</p>

<figure class='code'><figcaption><span>Here&#8217;s an example of Test::Fake::HTTPD. </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#!/usr/bin/env perl</span>
</span><span class='line'><span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="nn">Test::</span><span class="n">More</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">Test::Fake::</span><span class="n">HTTPD</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">JSON::</span><span class="n">XS</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">Furl::</span><span class="n">HTTP</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">subtest</span> <span class="n">api</span> <span class="o">=&gt;</span> <span class="k">sub </span><span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$response</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;/1/statuses/user_timeline/takus.json?count=1&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="s">&#39;created_at&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;Thu Mar 21 07:22:25 +0000 2013&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="s">&#39;text&#39;</span>       <span class="o">=&gt;</span> <span class="s">&#39;Hello, world&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="s">&#39;user&#39;</span>       <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>                    <span class="s">&#39;screen_name&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;takus&#39;</span><span class="p">,</span>
</span><span class='line'>                    <span class="s">&#39;lang&#39;</span>        <span class="o">=&gt;</span> <span class="s">&#39;en&#39;</span><span class="p">,</span>
</span><span class='line'>                    <span class="s">&#39;location&#39;</span>    <span class="o">=&gt;</span> <span class="s">&#39;Tokyo, Japan&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="p">},</span>
</span><span class='line'>                <span class="s">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;314638108048097280&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$httpd</span> <span class="o">=</span> <span class="n">run_http_server</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">my</span> <span class="nv">$req</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="n">uri</span> <span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nn">HTTP::</span><span class="n">Response</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span>
</span><span class='line'>                <span class="mi">200</span><span class="p">,</span> <span class="s">&#39;ok&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="p">[</span> <span class="s">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;text/html&#39;</span> <span class="p">],</span>
</span><span class='line'>                <span class="n">encode_json</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="n">uri</span> <span class="p">}</span>
</span><span class='line'>            <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="nn">HTTP::</span><span class="n">Response</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span>
</span><span class='line'>            <span class="mi">404</span><span class="p">,</span>
</span><span class='line'>            <span class="nv">$req</span><span class="o">-&gt;</span><span class="n">uri</span> <span class="o">.</span> <span class="s">&quot; is not found&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="p">[</span> <span class="s">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s">&#39;text/html&#39;</span> <span class="p">],</span> <span class="s">&quot;{}&quot;</span>
</span><span class='line'>        <span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># API client</span>
</span><span class='line'>    <span class="k">my</span> <span class="p">(</span> <span class="nv">$minor_version</span><span class="p">,</span> <span class="nv">$code</span><span class="p">,</span> <span class="nv">$msg</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">,</span> <span class="nv">$body</span> <span class="p">)</span> <span class="o">=</span> <span class="nn">Furl::</span><span class="n">HTTP</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">(</span>
</span><span class='line'>        <span class="n">method</span>     <span class="o">=&gt;</span> <span class="s">&#39;GET&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="n">host</span>       <span class="o">=&gt;</span> <span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="n">port</span>       <span class="o">=&gt;</span> <span class="nv">$httpd</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">,</span>
</span><span class='line'>        <span class="n">path_query</span> <span class="o">=&gt;</span> <span class="s">&#39;/1/statuses/user_timeline/takus.json?count=1&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">my</span> <span class="nv">$tweet</span> <span class="o">=</span> <span class="n">decode_json</span><span class="p">(</span><span class="nv">$body</span><span class="p">);</span>
</span><span class='line'>    <span class="n">is</span> <span class="nv">$tweet</span><span class="o">-&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">user</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">screen_name</span><span class="p">},</span> <span class="s">&#39;takus&#39;</span><span class="p">,</span> <span class="s">&#39;screen_name&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="n">is</span> <span class="nv">$tweet</span><span class="o">-&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">id</span><span class="p">},</span> <span class="s">&#39;314638108048097280&#39;</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="n">is</span> <span class="nv">$tweet</span><span class="o">-&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">text</span><span class="p">},</span> <span class="s">&#39;Hello, world&#39;</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">done_testing</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>参考リンク</h2>

<ul>
<li><a href="http://perl-users.jp/articles/advent-calendar/2011/test/8">HTTP通信を含むモジュールのテスト</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/01/01/2012-to-2013/">2012 年を振り返って</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2013/01/01/2012-to-2013/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2013/01/01/2012-to-2013/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-01-01T03:22:00-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>3:22 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>あけましておめでとうございます。年越し前に書こうと思っていましたが、あけおめ砲に備えて色々準備してるうちにいつの間にか年越ししてしまっていたので、今さらながら 2012 年を振り返ってみます。</p>

<p><img src="http://pcdn.500px.net/9882539/0eb0c471c85fbacab2d06939b8079aff61de1641/4.jpg" width="640" height="480" title="'Dubrovnik Old City by Takumi Sakamoto (takus) on 500px.com'" ><br/>
<a href="http://500px.com/photo/9882539">Dubrovnik: The best place I&rsquo;ve been to last year</a></p>

<h2>卒業</h2>

<p>今となっては大学院を卒業したのが遠い昔のように思いますが、2012 年の出来事だったんですよね。当時、インフラを担当してた <a href="http://my365.in">My365</a> が順調に伸びつつあったので、成長に合わせてスケールするように色々と試行錯誤しながら、修士論文＋国際会議用の論文を書いていたので、両方とも中途半端な感じになってしまったことは自分としては非常に残念でした。結果的に My365 はその頃のシステムをベースに今も動き続けいて、論文は <a href="http://www.computer.org/csdl/proceedings/cloud/2012/4755/00/4755a974-abs.html">Short Paper</a> として <a href="http://www.thecloudcomputing.org/2012/">IEEE CLOUD 2012</a> という会議に採録されたわけで、全て失敗したというわけでもないのですが、振り返ってみればどちらよくできる部分があったんじゃなかという反省ばかりです&hellip;。</p>

<h2>就職</h2>

<p>仕事は無事に希望通りの部署に配属されて、大規模 Web サービスのインフラの面倒をみるようなお仕事をしています。システムの規模もそれに関わる人の数も、今まで少人数で見てたサービスとは桁違いで、最初は戸惑う部分も多かったですが、10 ヶ月も経つとできることも増えてきて、毎日楽しく働けています。</p>

<h2>課外活動</h2>

<p>仕事以外でも <a href="/2012/06/18/28199466903/">モヒカン揃いの Monitoring casual #1 で発表</a> してみたり、<a href="https://twitter.com/shun0102">@shun0102</a> と<a href="http://engineer.dena.jp/2012/07/web.html">&ldquo;Web若手エンジニアの会&rdquo; を立ち上げたり</a>、<a href="/2012/10/06/32974165602/">YAPC::ASIA 2012 のボランティア</a> をやってみたりと振り返れば色々なイベントに参加した 1 年でした。</p>

<p>特に、カジュアルに始めた <em>&ldquo;Web若手エンジニアの会&rdquo;</em> が気がつけば 3 回もやった上に、前回は 50 人規模になるような大きなイベントになってビックリしていますが、オモシロイ人もたくさん来てくれるようになっていいイベントになりつつあり、会場提供してくれてる会社の方々や、興味深い発表をしてくれるスピーカーの方々にはただただ感謝するばかりです。</p>

<h2>プライベート</h2>

<p>2012 年はヨーロッパ、グアム、台北など色々な所に旅行に行きました。中でも <a href="/2012/03/24/28199464257/">3 月のクロアチア〜スロベニア〜イタリア 1 人旅</a> は、ほんとに一日一日が刺激的で<em>「旅は麻薬みたいなものだ」</em>と言ってる人の気持ちがようやく分かったような気がします。</p>

<h2>まとめ</h2>

<p>技術に関するエントリが出てこないこの振り返りエントリに象徴されるように、アウトプットが少ないのは大きな反省点で、2013 年はもっとアウトプットを意識しながら過ごしていきたいと思っています。</p>

<p>というわけで、今年もよろしくお願いいたします。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/12/20/mac-forget-me-not/">Macbook で外部ディスプレイ接続時にウィンドウをイイカンジに並べる</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2012/12/20/mac-forget-me-not/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2012/12/20/mac-forget-me-not/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-20T02:00:00-08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="http://farm6.staticflickr.com/5063/5556853286_09066cac50_z.jpg" width="640" height="427"><br/>
By <a href="http://www.flickr.com/photos/kofoed/3751360757/">Theis Kofoed Hjorth</a></p>

<p>Macbook で外部ディスプレイを利用してる人なら「このウィンドウはここに配置しておきたい！」みたいなのがあるかと思います。自分の場合は、MacbookAir のディスプレイにブラウザと Twitter、メインディスプレイに作業用のターミナル、サブディスプレイにサービスのダッシュボードやエラーログを tail するターミナルなんかを並べていて、各ウィンドウごとにポジションを決めて使っています。</p>

<p>しかし、Mac では会議などのために外部ディスプレイを外してしまうとせっかく好みの位置に並べたウィンドウが元の位置に戻ってしまいます。で、また会議から戻ってくると、自分好みの位置にチマチマ並べ直すわけですが、毎回こんな作業やるなんて面倒ですよね。</p>

<p>そこで自分は <a href="http://www.n8gray.org/code/forget-me-not/">forget-me-not</a> というソフトを使っています。このアプリは外部ディスプレイを接続した時のウィンドウ配置を記憶しておいてくれて、再接続時に自動で復元してくれるので、上にあげたような悩みをズバリ解決してくれてます。おまけに無料です！</p>

<p>自分は forget-me-not で十分なのでほかのソフトは調べてませんが、他にも有料のより高機能なソフトがあったり、<a href="https://twitter.com/hirose31">@hirose31</a> さんのように AppleScript で好みの配置に並べるという手もあるようなので、参考までに並べておきます。自分も興味あるので、使ってみた感想とかあれば教えていただけると嬉しいです。</p>

<h2>追記 2012/12/21</h2>

<p>モロ被りなタイミングで <a href="https://twitter.com/kenjiskywalker">@kenjiskywalker</a> さんが <a href="http://cordlessdog.com/stay/">Stay</a> の<a href="http://d.hatena.ne.jp/kenjiskywalker/20121219/1355932932">紹介記事</a>を書いてらっしゃったので参考リンクに追加させていただきます。forget-me-not が環境によってはうまく動かなかったりすることもあるみたいなので、そんな方は Stay を試してみるといいかもしれません。買ってみようと思った方はぜひあちらのブログのリンクを踏んで買っていただければと思います！</p>

<h2>参考リンク</h2>

<ul>
<li><a href="http://www.n8gray.org/code/forget-me-not/">forget-me-not</a></li>
<li><a href="http://d.hatena.ne.jp/kenjiskywalker/20121219/1355932932">StayさえあればもうMBAをサブディスプレイに繋げるのは怖くない &ndash; kenjiskywalker no memo</a></li>
<li><a href="http://d.hatena.ne.jp/hirose31/20101007/1286383903">ウィンドウをキッチリカッチリ配置したい &ndash; (ひ)メモ</a></li>
<li><a href="http://www.autumnapps.com/breeze/">breeze</a></li>
<li><a href="http://cordlessdog.com/stay/">stay</a></li>
<li><a href="http://mizage.com/divvy/">divvy</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/10/06/32974165602/">YAPC::ASIA 2012 に行ってきた</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2012/10/06/32974165602/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2012/10/06/32974165602/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-10-06T00:00:00-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ブログを書くまでが YAPC ということで，遅ればせながらブログを書こうと思います．ブログが数ヶ月ぶりの更新ですね…orz</p>

<h2>事実を積み上げて判断。古典的でも地道にやる</h2>

<p>@myfinder さんの「<a href="http://www.slideshare.net/myfinder/50msperl">平均レスポンスタイム50msをPerlで捌く中規模サービスの実装/運用</a>」の中で，キーワード的に何度も出てきていたこの言葉がすごく印象に残りました．常に正しい判断をするために地道に努力している姿勢は見習うべきものだなーと感心して，自分もそういうエンジニアでありたいなと改めて思いました．</p>

<h2>ボランティアスタッフとして</h2>

<p>今回はボランティアスタッフとして YAPC に携わらせていただきました。平日じゃありえないくらい早起きしたり，一般で参加するよりは大変でしたが，このような素晴らしいカンファレンスにスタッフとして携われたのはすごくいい経験になったと思います．また，去年の YAPC で最後にスタッフが壇上に上がっていて羨ましいなと思ったのですが，今年は自分がそこにいられてすごく嬉しかったです．</p>

<h2>反省</h2>

<p>去年の感想エントリに「何か発表したいなー」と書いておきながら，何も喋らなかったのが残念すぎでした．自分のくだらない話してもしょうがないなーという思いがどっかにありましたが，talk を聞いていると同じようなことやってたり考えてる人は結構いるわけで，とりあえず「my365 インフラ成長の軌跡と反省点」みたいな内容で喋ってみればよかった･･･．ひとまず今後は申し込みドリブンでネタ考えて発表するみたいなことをもっとやっていかないといけないと思いました．</p>

<h2>まとめ</h2>

<p>というわけで，スタッフのみなさん，スピーカーのみなさん，参加者のみなさんお疲れ様でした．また来年もよろしくお願いいたします．</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/07/24/28199469096/">会社のブログを書きました</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2012/07/24/28199469096/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2012/07/24/28199469096/"></a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-24T00:00:00-07:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://engineer.dena.jp/2012/07/web.html">「Web若手エンジニアの会」を開催しました &ndash; Technology of DeNA</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page5">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page3">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <div style="margin-top:10px">
    <img src="http://farm8.staticflickr.com/7293/11929418323_e084604fe5_q.jpg" alt="me"><br />
    Takumi Sakamoto<br />
    Software Engineer@SmartNews, Inc.<br />
  </div>
  <div style="margin-top:10px">
    <a href="http://twitter.com/takus" class="twitter-follow-button" data-show-count="true">Follow @takus</a>
  </div>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/11/12/reinvent-2014-day1/">AWS re:Invent 2014 day1</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2014/11/12/reinvent-2014-day1/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2014/11/12/reinvent-2014-day1/"></a>
      </li>
    
      <li class="post">
        <a href="/2014/08/31/yapc-asia-2014/">YAPC::Asia 2014 にいってきた #yapcasia</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2014/08/31/yapc-asia-2014/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2014/08/31/yapc-asia-2014/"></a>
      </li>
    
      <li class="post">
        <a href="/2014/08/01/join-smartnews/">スマートニュースにジョインしました</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2014/08/01/join-smartnews/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2014/08/01/join-smartnews/"></a>
      </li>
    
      <li class="post">
        <a href="/2014/07/31/got-married-and-leave-dena/">結婚しました & 退職します</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2014/07/31/got-married-and-leave-dena/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2014/07/31/got-married-and-leave-dena/"></a>
      </li>
    
      <li class="post">
        <a href="/2014/05/16/travel-to-barcelona/">Barcelona にいってきた</a><a href="http://b.hatena.ne.jp/entry/http://blog.takus.me/2014/05/16/travel-to-barcelona/"><img src="http://b.hatena.ne.jp/entry/image/large/http://blog.takus.me/2014/05/16/travel-to-barcelona/"></a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/takus">@takus</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'takus',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Takumi Sakamoto -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'takus';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
